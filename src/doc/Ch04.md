# 다른 페이지 처리하기
- 현재 작성한 기능은 HTTP 요청으로 부터 ToDoList가 포함된 HTML 문서를 반환하는 함수를 만들었다. 새로운 기능을 추가하려면 어떻게 해야 할까?
- 기존에 작성한 함수는 건들지 않겠다. 그 함수는 그대로 완성된 함수이며, 다른 종류의 호출을 신경 쓰지 않아야 한다.
- 하드코딩된 값으로 너무 구체적인 함수를 작성하는 것도 원치 않는다. 재사용하기 힘들기 때문이다.
- 서로 다른 종류의 Request를 처리하는 함수를 기존 코드를 변경하지 않고 어떻게 결합할 수 있을까?
  - 함수 컬렉션을 입력으로 받고 새 함수를 반환하는 함 수가 필요하다.

# 함수적 의존관계 주입
- 코드에서 외부 의존관계를 사용해야 하는 경우, 이를 직접 생성하지 말고 외부에서 전달받아야 한다
- 외부 의존관계의 생성과 사용을 분리하면 서로 다른 동작을 기대하는 여러 구현을 전달할 수 있기 때 문에 코드가 더 유연하고 테스트하기 좋아진다.
- 허브가 외부 리소스에 대한 접근을 위임하는 방법, 즉 허브 내부에 함수를 주입해 도메인에서 외부 서 비스와 통신할 수 있도록 허용하는 방법을 알아보자

## 객체 지향 의존관계 주입
- 객체 지향에서 `의존 관계의 생성`: 어떤 객체를 직접 만들어내는 것
- 객체 지향에서 `의존 관계의 사용`: 생성한 객체의 기능을 사용하는 것
- 객체 지향에서 `의존관계 주입`: 객체에게 필요한 의존관계(객체)를 객체가 스스로 생성하는 대신 외부에서 전달받는 것
  - 필요한 객체를 생성자, 메서드로 주입 or 애너테이션이나 외부 구성 파일 같은 메타 프로그래밍 기법을 사용해 주입

## 함수형 의존관계 주입
- 함수형 프로그래밍에선 객체보다 함수를 더 선호한다
  - 의존관계를 함수로 주요 함수에 전달해야 한다
  - 의존관계를 인자로 받아들여서 함수 내부에서 그 의존관계를 포함하는 함수를 생성하는 다른 함수를 사용하는 것!

## 커링(currying)
- 함수를 여러 개의 인자를 받는 형태에서, 하나의 인자만 받는 함수들의 연쇄로 바꾸는 개념

## 함수의 부분 적용 기법 (Partial Application)
- 함수의 일부 인자만 고정해서 새로운 함수를 만드는 것.

```kotlin
fun <A,B,C,R> partial(f: (A,B,C) -> R, a: A): (B,C) -> R = { 
  b, c -> f(a,b,c)
}
```
- 해석하면 아래와 같다
```kotlin
fun <A, B, C, R> partial(
    f: (A, B, C) -> R,  // 세 개의 인자를 받아 R을 반환하는 함수
    a: A                // 첫 번째 인자 고정값
): (B, C) -> R =        // 반환 타입: 두 인자를 받는 함수
    { b, c -> f(a, b, c) } // 고정된 a와 새로운 b, c를 사용해 f를 호출
```
- `<A, B, C, R>`: 제네릭 타입 매개변수 4개 (입력 3개, 반환 1개)
- `f: (A, B, C) -> R`: 세 개의 인자를 받아 결과를 내는 함수
- `a: A`: f의 첫 번째 인자를 고정할 값
- 반환값: `(B, C) -> R`
  즉, 이제 두 개의 인자만 받는 새 함수를 만들어 반환

### `partial` 함수 사용 예제
```kotlin
fun <A,B,C,R> partial(f: (A,B,C) -> R, a: A): (B,C) -> R = { 
  b, c -> f(a,b,c)
}

fun greet(hour: Int, name: String, punctuation: String): String {
    return "Good ${if (hour < 12) "morning" else "evening"}, $name$punctuation"
}

val greetAt9 = partial(::greet, 9) // hour를 9로 고정
val message1 = greetAt9("Alice", "!") // "Good morning, Alice!"
val message2 = greetAt9("Rapunzel", "?") // "Good morning, Rapunzel?"
```
